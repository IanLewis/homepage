{% extends "blog/base.html" %}
{% load truncate_chars %}
{% load pagination_tags %}
{% load tagging_tags %}
{% load blog_tags %}

{% block title %}Ian's Blog{% endblock %}
{% block blog_content %}
  {% autopaginate object_list 10 %}

  {% if object_list %}
    <ul>
    {% for item in object_list %}
      {% tags_for_object item as item_tags %}
      <li class="blog-post">
        <h1 class="post-title"><a href="{{ item.get_absolute_url }}">{{ item.title|safe }}</a></h1>
        <div class="post-date">{{ item.pub_date }}</div>
        <div class="post-tags">{% for tag in item_tags %}<a href="{% url blog_tag_page locale tag.name %}">{{ tag.name }}</a> {% endfor %}</div>
        <div class="post-body">
        {% if item.content %}
          {{ item|to_html|safe }}
        {% else %}
          &nbsp;
        {% endif %}
        </div>
        <div class="post-comment-link"><a href="http://www.ianlewis.org/en/tokyo-barcamp-2009#disqus_thread">Send feedback</a></div>
      </li>
    {% endfor %}
    </ul>
  {% endif %}
<br/>

{% paginate %}

{% endblock %}

{% block js_footer %}
<script type="text/javascript">
//<[CDATA[
(function() {
		var links = document.getElementsByTagName('a');
		var query = '?';
		for(var i = 0; i < links.length; i++) {
			if(links[i].href.indexOf('#disqus_thread') >= 0) {
				query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
			}
		}
		document.write('<script type="text/javascript" src="http://disqus.com/forums/ianlewisblog/get_num_replies.js' + query + '"></' + 'script>');
	})();
//]]>
</script>
{% endblock %}

{% block footer %}
<div class="tag-cloud">
{% tag_cloud_for_model blog.post as post_tags with steps=20 min_count=4 distribution=log %}
{% for post_tag in post_tags %}
<a style="font-size: {{ post_tag.font_size|add:"10" }}px;" href="{% url blog_tag_page locale post_tag.name %}">{{ post_tag.name }}</a>
{% endfor %}
</div>
{% endblock %}
